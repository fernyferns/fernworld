<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex">
    <title>Fernworld</title>
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chilanka&display=swap" rel="stylesheet">
    <style>
        html {
            margin-top: 1.5em;
            margin-bottom: 1.5em;
            margin-left: 2em;
            margin-right: 2em;
            max-width: 800px;
        }

        * {
            font-family: 'Chilanka';
        }

        p {
            margin-bottom: 1.3em;
        }

        .alert {
            background-color: lemonchiffon;
        }
    </style>
    <script src="./sjcl.js"></script>
</head>

<script>

    var alertShown = false;

    function login(manualLogin = false) {

        var password = "";

        try {

            if (manualLogin) {
                password = document.getElementById("password").value || "";
                localStorage.setItem("password", password);
                decryptAndRender(password);
                return;
            }

            else {

                //check if password is in query string
                password = getParameterByName("password");
                if (password) {
                    localStorage.setItem("password", password);
                    decryptAndRender(password);
                    return;
                }

                //check if password is already in storage
                password = localStorage.getItem("password");
                if (password) {
                    decryptAndRender(password);
                    return;
                }

            }

        } catch (error) {
            //clear session storage on error.
            localStorage.removeItem("password");
            if (error) {
                if (error.message == "ccm: tag doesn't match") {
                    showAlert("Password incorrect");
                } else if (error.message) {
                    showAlert(error.message);
                } else {
                    showAlert("Something went wrong.");
                }
            }
        }

    }

    function decryptAndRender(password) {
        var decryptedHtmlPage = sjcl.decrypt(password, encryptedHtml);
        document.open("text/html", "replace");
        document.write(decryptedHtmlPage);
        document.close();
    }

    function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    function showAlert(message) {
        var container = document.getElementById("alert");
        if (container) {
            container.outerHTML = `<p id="alert" class="alert" onClick="dismissAlert()"><a href="#" onClick="dismissAlert()">[x]</a>&nbsp;&nbsp;${message}</p>`;
            alertShown = true;
        }
    }

    function dismissAlert() {
        var container = document.getElementById("alert");
        if (container) {
            container.outerHTML = `<p id="alert"></p>`;
            alertShown = false;
        }
    }

    function passwordKeyPress(event) {
        if (alertShown) {
            dismissAlert();
        }
        if (event.key == "Enter") {
            login(true);
        }
    }

    var encryptedHtml = '{"iv":"t7E2e25ft9SBl6IelLDI+w==","v":1,"iter":10000,"ks":128,"ts":64,"mode":"ccm","adata":"","cipher":"aes","salt":"Ixabti4G6l0=","ct":"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"}';

    login();


</script>

<body onload="onLoad()">

    <noscript>
        <p class="alert">This site requires JavaScript to function. Login will not function without scripts enabled.</p>
    </noscript>

    <p id="alert"></p>

    <h1>
        Login
    </h1>

    <div>
        <label for="password">Password</label>
        <input type="password" id="password" required disabled onkeypress="passwordKeyPress(event)" />
        <p>Ask Fern if you don't know the password.</p>
    </div>

    <p>
        <button disabled type="button" id="loginBtn" onclick="login(true)">
            Login
        </button>
    </p>

    <script>

        function onLoad() {

            //enable login button.
            document.getElementById("loginBtn").removeAttribute("disabled");
            document.getElementById("password").removeAttribute("disabled");

            login();

        }

    </script>

</body>

</html>