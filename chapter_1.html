<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex">
    <title>Fernworld</title>
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Chilanka&display=swap" rel="stylesheet">
    <style>
        html {
            margin-top: 1.5em;
            margin-bottom: 1.5em;
            margin-left: 2em;
            margin-right: 2em;
            max-width: 800px;
        }

        * {
            font-family: 'Chilanka';
        }

        p {
            margin-bottom: 1.3em;
        }

        .alert {
            background-color: lemonchiffon;
        }
    </style>
    <script src="./sjcl.js"></script>
</head>

<script>

    var alertShown = false;

    function login(manualLogin = false) {

        var password = "";

        try {

            if (manualLogin) {
                password = document.getElementById("password").value || "";
                localStorage.setItem("password", password);
                decryptAndRender(password);
                return;
            }

            else {

                //check if password is in query string
                password = getParameterByName("password");
                if (password) {
                    localStorage.setItem("password", password);
                    decryptAndRender(password);
                    return;
                }

                //check if password is already in storage
                password = localStorage.getItem("password");
                if (password) {
                    decryptAndRender(password);
                    return;
                }

            }

        } catch (error) {
            //clear session storage on error.
            localStorage.removeItem("password");
            if (error) {
                if (error.message == "ccm: tag doesn't match") {
                    showAlert("Password incorrect");
                } else if (error.message) {
                    showAlert(error.message);
                } else {
                    showAlert("Something went wrong.");
                }
            }
        }

    }

    function decryptAndRender(password) {
        var decryptedHtmlPage = sjcl.decrypt(password, encryptedHtml);
        document.open("text/html", "replace");
        document.write(decryptedHtmlPage);
        document.close();
    }

    function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    function showAlert(message) {
        var container = document.getElementById("alert");
        if (container) {
            container.outerHTML = `<p id="alert" class="alert" onClick="dismissAlert()"><a href="#" onClick="dismissAlert()">[x]</a>&nbsp;&nbsp;${message}</p>`;
            alertShown = true;
        }
    }

    function dismissAlert() {
        var container = document.getElementById("alert");
        if (container) {
            container.outerHTML = `<p id="alert"></p>`;
            alertShown = false;
        }
    }

    function passwordKeyPress(event) {
        if (alertShown) {
            dismissAlert();
        }
        if (event.key == "Enter") {
            login(true);
        }
    }

    var encryptedHtml = '{"iv":"uRulUaAXSLUZHZoVVoF/YA==","v":1,"iter":10000,"ks":128,"ts":64,"mode":"ccm","adata":"","cipher":"aes","salt":"q/JLYWZTrII=","ct":"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"}';

    login();


</script>

<body onload="onLoad()">

    <noscript>
        <p class="alert">This site requires JavaScript to function. Login will not function without scripts enabled.</p>
    </noscript>

    <p id="alert"></p>

    <h1>
        Login
    </h1>

    <div>
        <label for="password">Password</label>
        <input type="password" id="password" required disabled onkeypress="passwordKeyPress(event)" />
        <p>Ask Fern if you don't know the password.</p>
    </div>

    <p>
        <button disabled type="button" id="loginBtn" onclick="login(true)">
            Login
        </button>
    </p>

    <script>

        function onLoad() {

            //enable login button.
            document.getElementById("loginBtn").removeAttribute("disabled");
            document.getElementById("password").removeAttribute("disabled");

            login();

        }

    </script>

</body>

</html>